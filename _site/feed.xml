<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.5.1">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2017-08-04T17:58:38+09:00</updated><id>http://localhost:4000/</id><title type="html">fkkmemi.notes | dev.logs –save</title><subtitle>dev.logs --save</subtitle><author><name>fkkmemi</name><email>fkkmemi@gmail.com</email></author><entry><title type="html">Renewal github page</title><link href="http://localhost:4000/talk/renewal/" rel="alternate" type="text/html" title="Renewal github page" /><published>2017-08-04T00:00:00+09:00</published><updated>2017-08-04T00:00:00+09:00</updated><id>http://localhost:4000/talk/renewal</id><content type="html" xml:base="http://localhost:4000/talk/renewal/">&lt;h2 id=&quot;개요&quot;&gt;개요&lt;/h2&gt;

&lt;p&gt;기존 jekyll-now 기본테마가 너무 흉해서 변경중&lt;/p&gt;

&lt;p&gt;변경하고 있는 테마는 minimal-mistakes&lt;/p&gt;

&lt;blockquote&gt;

&lt;/blockquote&gt;</content><author><name>fkkmemi</name><email>fkkmemi@gmail.com</email></author><category term="talk" /><category term="talk" /><summary type="html">개요</summary></entry><entry><title type="html">GTD(시간 관리)</title><link href="http://localhost:4000/talk/gtd/" rel="alternate" type="text/html" title="GTD(시간 관리)" /><published>2017-08-03T00:00:00+09:00</published><updated>2017-08-03T00:00:00+09:00</updated><id>http://localhost:4000/talk/gtd</id><content type="html" xml:base="http://localhost:4000/talk/gtd/">&lt;h2 id=&quot;개요&quot;&gt;개요&lt;/h2&gt;

&lt;p&gt;GTD란 데이비드 앨런(David Aallan)의 책, 할 일 관리(Getting Things Done, GTD)라는 것이다.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;개인이 효율적으로 시간을 관리하여 자신이 하고자 하는 일을 깔끔하게 해결하는 방법을 정리했다.&lt;br /&gt;
2001년에 처음 출판된 이후, IT 개발자들에게 열렬한 환영을 받으며 폭발적인 인기를 끌었다.&lt;br /&gt;
출처 - &lt;a href=&quot;https://ko.wikipedia.org/wiki/Getting_Things_Done&quot;&gt;https://ko.wikipedia.org/wiki/Getting_Things_Done&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;갑자기 GTD 타령 이유는..&lt;/p&gt;

&lt;p&gt;내가 미친드시 앞만보고 돌진 하는 성향으로 보고 무계획한 프로세스를 가지고 있는 것으로 오해할 수 있을 것 같아서이다..&lt;/p&gt;

&lt;p&gt;GTD라고 하기엔 뭔가 모자라지만..&lt;/p&gt;

&lt;p&gt;캘린더와 할일 목록(todo-list) 두가지로 시간관리와 기록은 꾸준히 하고있다…&lt;/p&gt;

&lt;h2 id=&quot;이유&quot;&gt;이유&lt;/h2&gt;

&lt;p&gt;절대 계획성 없이 들이댄다고 쉽게 얻어지지 않는 것이다..&lt;/p&gt;

&lt;p&gt;내 능력은 사실 강한 추진력, 빠른 속도, 재치있는 센스, 끝 없는 노력.. 이런게 아니다…&lt;/p&gt;

&lt;p&gt;진짜 나의 능력은 철저한 메모 능력(결국 GTD류)이라고 자부할 수 있다..&lt;/p&gt;

&lt;p&gt;구글링해서 gtd를 검색해보면 gtd를 사용하여 얼마나 체계적이고 다양한 방법으로 빠짐없이 일을 끝낼 수 있게 하는지…&lt;/p&gt;

&lt;p&gt;간결하게 하라느니 우선순위를 정하라느니 다양한 자기관리 방법에 가까운 좋은 이야기들이 많지만…&lt;/p&gt;

&lt;p&gt;그러나 난. 그런 이야길 하고 싶지 않다.. 그렇게 잘 하고 있는 쪽도 아니고..&lt;/p&gt;

&lt;p&gt;중요한 것은 지속성과 활용이다..&lt;/p&gt;

&lt;p&gt;한 오년 넘게 해온 것 같은데.. 거의 하루도 빠지지 않고 모든 일(집/회사)에 활용하였다.&lt;/p&gt;

&lt;h2 id=&quot;사용&quot;&gt;사용&lt;/h2&gt;

&lt;h3 id=&quot;todo-list&quot;&gt;todo-list&lt;/h3&gt;

&lt;p&gt;구글 캘린더의 todo를 쓰다가 내 장비들이 어쩌다보니 apple 생태계쪽(집/회사:아이맥X2,맥북X2,타임캡슐,아이패드,아이폰들)이라서..&lt;br /&gt;
결국 iPhone4 나올때부터 iCloud 연동하여 주욱 미리알림만 쓰고있다…&lt;/p&gt;

&lt;p&gt;미리알림과 연동되는 혹은 비슷한 수 많은 어플들은 역시 순정을 이길 수 없었다..&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;미리알림 : 맥북&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/gtd/1.png&quot; alt=&quot;alt todo&quot; /&gt;&lt;/p&gt;

&lt;p&gt;이럴 때 각 그룹에 추가해서 쓰고 있다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;해야할 일&lt;br /&gt;
주로 기한을 둔다.. 해야할 일이니까… 사소한 모든 것을 적는다. - 매일 확인
    &lt;ul&gt;
      &lt;li&gt;job&lt;br /&gt;
  eg) 펌웨어 배포 언제까지, DB backup 언제까지, lw switch color 변경&lt;/li&gt;
      &lt;li&gt;home:집 공유&lt;br /&gt;
  eg) 계란 우유 토마토 구매, 사진 백업&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;번뜩이는 아이디어&lt;br /&gt;
문득 생각나면 바로 적는다 기한 없이.. - 시간 날때 한번 확인
    &lt;ul&gt;
      &lt;li&gt;idea&lt;br /&gt;
  eg) 채팅 기능을 넣어볼까, 로긴 맘 껏 못하게 리캡챠 넣어볼까?&lt;/li&gt;
      &lt;li&gt;art&lt;br /&gt;
  eg) 지나가다 음악을 듣고 그 영화가 보고싶을때&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;하고 싶은 일&lt;br /&gt;
무기한으로 하고 싶은 일을 적는다.. - 지치고 힘들때 확인&lt;br /&gt;
정말 하고 싶었던 것들… 별거 아닌 것 같지만 사람은 잊는다. 자기가 뭘 좋아했는지도..&lt;br /&gt;
다르게 말하면 잉여력이라고 해야할까…&lt;br /&gt;
문제는 DONE! 이 빨리 되지가 않는다… 체크하려면 한참임..
    &lt;ul&gt;
      &lt;li&gt;hope   &lt;br /&gt;
  eg) node.js, vue.js, android app, iOS app 등 다 적어두었던 것을 하나씩 클리어하고 있는중..&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;그룹공유가된 항목들은 읽기,쓰기,푸쉬가 다 가능하기 때문에 용도별로 다르게 쓰면 된다.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;그룹공유로 팀원과 코웤하며 팀장이 괴롭힐 수도 있을 것 같다..&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;멍때리며 생각을 많이 하는 편인데 자다가도 술먹다가도 화장실에 있다가도 불현듯 떠오른 아이디어를 일단 적는다..&lt;/p&gt;

&lt;p&gt;이때 키포인트는.. 두가지&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;쓰는 데 공을 들이면 안된다..(당연히..)&lt;br /&gt;
 우선순위를 줄 수도 있지만 클릭 한번이 귀찮으므로 안하는 게 좋았다.
 그냥 오타가 나든 잘못 쓰든 나만 알아볼 수 있는 단어 혹은 문장으로 빠르게 휘리릭 써야한다..(어짜피 나만 보잖어.. 그리고 아직도 모바일 타이핑이 늘지가 않는다…)&lt;br /&gt;
 문제는 오타가 너무많은 채로 그것을 빨리 보지 않으면 나중에 본인도 뭔 소린지 이해를 못하게 된다..    &lt;br /&gt;
 그래서 하루에 딱 한번정도만 내가 쓴 것을 오타 수정해주면 됨&lt;br /&gt;
 eg) 자다가 생각 남 : nwjs로 양산 프로그램 변경 (실제 기입 : nw yags //한영바꾸기 귀찮아서 게다가 오타도 괜춘)&lt;/li&gt;
  &lt;li&gt;아주 사소한 것도 일단 적어야 된다..&lt;br /&gt;
 얼마나 사소한 것을 적냐면…&lt;br /&gt;
 eg) 화장실에서 갑자기 떠오름 : 버튼 라운딩이 안어울리는 것 같네.. 라운드를 8에서 5로 줘보자(실제 기입 : 버튼 라 8,5)&lt;br /&gt;
 eg) 밥먹다 생각 남 : copyright font 13-&amp;gt;12 (실제 기입 : 카피글 작게)&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;별 것 아닌 것 같지만..&lt;/p&gt;

&lt;p&gt;저 때 생각한 버튼의 라운드, 폰트의 크기가, 그라데이션들이 한땀한땀의 아이디어와 다양한 생각이 ….&lt;/p&gt;

&lt;p&gt;그 정성이 뭔가를 만든 것이지 빠른 코딩과 재빠른 판단 력으로는 아마추어급 제품만 나올 뿐이다..&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;calendar&quot;&gt;calendar&lt;/h3&gt;

&lt;p&gt;캘린더를 쓴지는 약 7년이 다되어간다..&lt;/p&gt;

&lt;p&gt;업무 관련은 공유 문제로 구글캘린더를 쓰고 개인적인 것들은 iCloud를 사용한다.&lt;/p&gt;

&lt;p&gt;캘린더의 원래 목적은 아마도 계획성(다가올 미래의 어느 날에 무엇을 하는 것인지를 적는 것)이라고 보지만 난 반대로 쓰고 있다..&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;캘린더(주) : 맥북&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/gtd/2.png&quot; alt=&quot;alt calendar1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;캘린더(월) : 맥북&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/gtd/3.png&quot; alt=&quot;alt calendar2&quot; /&gt;&lt;/p&gt;

&lt;p&gt;캘린더를 보면 거의 매 시간 간격으로 기록이 되어 있다.&lt;/p&gt;

&lt;p&gt;이유는 바로.. 매 시간마다 정말 기록하기 때문이다 시간보고서 같이…&lt;/p&gt;

&lt;p&gt;외근을 나가거나 쓰기 귀찮아서 어제 쓰지 않았다면 오늘 어제 일을 기록할 수도 있다..&lt;/p&gt;

&lt;p&gt;그림의 주황색은 나의 팀원 캘린더다..&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;나랑 일하려면 어쩔 수 없다..&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;구글과 애플 디비에 내 흔적이 고스란히 남아 있는 것이다..&lt;/p&gt;

&lt;p&gt;캘린더는 용도별로 틀린데 대표적인 거 몇개만 나열하면&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;job : 팀원 전체 공유&lt;br /&gt;
일한 것을 죄다 기록 : 주간 보고 쓸 필요 없다&lt;/li&gt;
  &lt;li&gt;project : 관련 팀원 공유&lt;br /&gt;
특정 프로젝트가 진행 될 때 해당 프로젝트 캘린더를 생성해서 따로 관리 : 프로젝트 보고서용&lt;/li&gt;
  &lt;li&gt;private&lt;br /&gt;
누구와 술마셨는지 등 : “지난 주에 2번 마셨어 오늘은 안돼…”&lt;/li&gt;
  &lt;li&gt;home :  공유&lt;br /&gt;
어딜 놀러 갔는지, 뭘 샀는지 등&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;이런 짓?을 하는 이유는&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;보고 &lt;br /&gt;
주간보고등을 쓰려해도 한 이틀정도만 지나면 그저께 뭐했는지 잘 기억이 나질 않는다..&lt;br /&gt;
공유가 되어 있기 때문에 서로 주간보고를 따로 할 이유는 없다..&lt;br /&gt;
대부분 공유가 되어 있어도 보질 않지만…&lt;/li&gt;
  &lt;li&gt;명분&lt;br /&gt;
“갑자기 왜 일이 이렇게 되었어? 5월달에 뭐했어?”&lt;br /&gt;
-&amp;gt; 캘린더 앱을 연다 월 보기모드 한장 주간 보기모드 5장 출력해서 보여준다.&lt;/li&gt;
  &lt;li&gt;확인&lt;br /&gt;
기간을 보며 일의 강도와 잘못된 부분을 검토한다.&lt;/li&gt;
  &lt;li&gt;추억&lt;br /&gt;
어떻게 보면 나름의 일기장이라 당시 고민했던 풋내를 맡고 싶을 때..&lt;/li&gt;
  &lt;li&gt;집착&lt;br /&gt;
그냥 정신병.. 지금 까지 한게 아까워서 계속 함..&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;키포인트는 투두와 같이 공들이면 안되고 사소한것도 다 적어야하는 것인데…&lt;/p&gt;

&lt;p&gt;공유된 캘린더는 다른 사람이 이해할 수 있게 오타를 줄이고 설명에 약간 노력을 기울이는 것이다..&lt;/p&gt;

&lt;p&gt;추가적으로 필요하다 보는 것은 바로 색인용 키워드를 앞에 넣어주는 것이다..(검색할 때 좋다)&lt;/p&gt;

&lt;p&gt;쌍따옴표니 괄호니 필요 없고 검색시 편한 문자를 앞에 추가하는 것이다. 검색 잘되게 하려면 키워드 두개를 넣어도 좋다.&lt;/p&gt;

&lt;p&gt;eg) office 서류 제출, hw 펌웨어 배포 3.4.5, web lw ajax call error 처리&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;마치며&quot;&gt;마치며&lt;/h2&gt;

&lt;p&gt;내 캘린더중 임의의 주를 스크린샷한 것인데 죄다 일만한 것으로 표현되어 있어서 일벌레로 오해하면 안된다..(하필 3년에 한번 있는 일요일도 일한 주를.. )&lt;/p&gt;

&lt;p&gt;난 게임, 만화등 엔터 컨텐츠 소비자이기도 해서 캘린더에 떠억하니 게임 3시간 같은 것도 종종 기록되어 있다..&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;물론 어느 회사,팀이나 통용되지는 않을 것이다. 나름 자유분방한 회사라 가능한 것이다..&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;누구나 마찬가지 겠지만 생산성이 매일 고르게 좋을 수도 없고 창의력도 떨어지고 뭔가 안 풀릴 때 오히려 잠시 릴렉스해야 더 좋은 결과가 나온다고 믿고 있기 때문이다.&lt;/p&gt;

&lt;p&gt;이건 어디까지나 일처리가 마무리 되고 나서를 얘기하는 것이다.&lt;/p&gt;

&lt;p&gt;모든 행동, 일에는 책임이 따르는 법이다..&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;가끔 누군가가 특정 일은 바빠서 못한다느니 할 수 있다…&lt;br /&gt;
하지만 나에겐 안통한다.. 위에 언급한 것처럼 논리적인 명분을 가지고 덤벼야하는 것이다..&lt;br /&gt;
한시간 한시간에 대한 소요 시간의 이유와 역량을 모두 판단해야한다..&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;팀원이 8시간 근무에 5시간 게임을 해도 난 상관 없다.. 3시간만에 업무를 마친 능력 있는 자유인일 뿐이니까..&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;물론 그런 경우가 잦아지면 8시간에 못할 강도의 일을 주면 된다..(원치는 않지만 타인에 의한 자기개발로 유도 가능)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;오히려 8시간 근무에 8시간 이상 일을 하면서 그 이유에 대한 설명도 명분도 없이 멍한 케이스가 문제다.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;야근하고 고생하고 이슈화 시켜서 대단한 일로 포장한다..&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;열심히 일하며 밤새는 것도 물론 중요하지만 회사는 개인이 아니다.. 해결 방법을 모색하고 계획하고 풀어가는 것이 더 중요한 것이라고 본다..&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;내가 해결 못할 문제를 다른 사람과 같이 논의해서 푸는 것도 능력이다..&lt;br /&gt;
오히려 훌륭한 프로그래머보다 일을 마무리 할 수 있는 사람이 더 중요하다..&lt;/p&gt;
&lt;/blockquote&gt;</content><author><name>fkkmemi</name><email>fkkmemi@gmail.com</email></author><category term="talk" /><category term="idea" /><category term="talk" /><category term="gtd" /><summary type="html">개요</summary></entry><entry><title type="html">NEMV 5 - vue.js 설치</title><link href="http://localhost:4000/nemv/nemv-5/" rel="alternate" type="text/html" title="NEMV 5 - vue.js 설치" /><published>2017-08-02T00:00:00+09:00</published><updated>2017-08-02T00:00:00+09:00</updated><id>http://localhost:4000/nemv/nemv%205</id><content type="html" xml:base="http://localhost:4000/nemv/nemv-5/">&lt;h3 id=&quot;webpack&quot;&gt;webpack&lt;/h3&gt;

&lt;p&gt;vue-cli로 빌드하기 위해서는 웹팩이 필요한 것 같다.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;vue-cli를 깔면 웬지 종속으로 설치 될 것 같긴 하지만 안해봤으니 .. 일단 깔아본다..&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;웹팩은 대략 모듈번들러라는 개념이며 내가 알고 있는건 단순히 지저분한 js파일들을 묶어주는 것이다.&lt;/p&gt;

&lt;p&gt;더 자세한 내용은 webpack은 공식사이트에서 충분히 숙지하고 접근하는 것이 좋다..&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://webpack.js.org&quot;&gt;https://webpack.js.org&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;공식사이트에 가서 그림을 보니 대충 이해는 하겠다..&lt;br /&gt;
하지만 아직 안써봤으니 직접 설치해보고 뭔지 역으로 알아보도록 하겠다. 뭔가 더 훌륭한 놈 같은데…&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;그리고 클론&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;git clone https://github.com/fkkmemi/nemv.git
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;webpack 전역 설치&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo npm install -g webpack
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vue-cli&quot;&gt;vue-cli&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;vue-cli 전역 설치&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo npm install -g vue-cli
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;jquery 설치&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;npm i --save-dev expose-loader
npm i --save jquery
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;import jquery&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;import 'expose-loader?$!expose-loader?jQuery!jquery'
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;bootstrap 설치&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;npm i --save bootstrap
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;import bootstrap&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;import 'bootstrap'
import 'bootstrap/dist/css/bootstrap.min.css'
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://vuejs-kr.github.io/jekyll/update/2017/03/02/vuejs-jquery-bootstrap/&quot;&gt;https://vuejs-kr.github.io/jekyll/update/2017/03/02/vuejs-jquery-bootstrap/&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;잠시 쉼..&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;strong&gt;이전 &lt;a href=&quot;/nemv-4/&quot;&gt;NEMV 4 - node.js &amp;amp; express &amp;amp; mongoDB 설치&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;</content><author><name>fkkmemi</name><email>fkkmemi@gmail.com</email></author><category term="nemv" /><category term="node" /><category term="mongo" /><category term="express" /><category term="vue" /><summary type="html">webpack</summary></entry><entry><title type="html">NEMV 4 - node.js &amp;amp; express &amp;amp; mongoDB 설치</title><link href="http://localhost:4000/nemv/nemv-4/" rel="alternate" type="text/html" title="NEMV 4 - node.js &amp; express &amp; mongoDB 설치" /><published>2017-08-02T00:00:00+09:00</published><updated>2017-08-02T00:00:00+09:00</updated><id>http://localhost:4000/nemv/nemv%204</id><content type="html" xml:base="http://localhost:4000/nemv/nemv-4/">&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;node.js&lt;/p&gt;

    &lt;p&gt;node.js는 현재 목적에서는 javascript언어로 제작가능한 서버 정도가 되겠다..&lt;/p&gt;

    &lt;p&gt;하지만 노드를 서버로 국한시키는 것은 말도 안되는 이야기다..&lt;/p&gt;

    &lt;p&gt;예전에 ARM 기반 임베디드 리눅스로 노드가 한 일은 아래와 같다.. by artik : &lt;a href=&quot;https://www.artik.io&quot;&gt;https://www.artik.io&lt;/a&gt;&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;웹서버&lt;/li&gt;
      &lt;li&gt;RS232로 lcd monitor 출력&lt;/li&gt;
      &lt;li&gt;mariadb&lt;/li&gt;
      &lt;li&gt;tcp client/server&lt;/li&gt;
      &lt;li&gt;linux command(eg: $ reboot)&lt;/li&gt;
      &lt;li&gt;bluetooth : beacon search&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;노드는 다양한 플랫폼에서 돌아가는 프레임워크라고 보는게 맞다. 아래의 다운로드 링크를 보면 다양한 플랫폼에서 돌아가게 되어있다..&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;더 자세한 것은 구글링하여 말재주가 화려한 사이트에서 확인해본다..&lt;/p&gt;
    &lt;/blockquote&gt;

    &lt;p&gt;어떤 CPU든, 어떤 OS든 손쉽게 다양한 어플리케이션(꼭 서버가 아닌..)을 작성할 수 있는 것이다.&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;https://nodejs.org/en/download/&quot;&gt;https://nodejs.org/en/download/&lt;/a&gt;&lt;/p&gt;

    &lt;p&gt;이중 안정적인 LTS(Long Term Support)버전을 깔면된다.&lt;/p&gt;

    &lt;p&gt;리눅스 서버를 사용하고 있다면 패키지매니저를 통해 설치하는 것이 편리하다.  아래에서 확인해본다.&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;https://nodejs.org/en/download/package-manager/&quot;&gt;https://nodejs.org/en/download/package-manager/&lt;/a&gt;&lt;/p&gt;

    &lt;p&gt;npm은 패키지 설치 매니저인데 왠만한 것들은 npm을 이용해 죄다 깔 수가 있다..
 node가 클 수 있었던건 아마도 npm일듯하다. 방대한량의 자료들을 보라.. &lt;a href=&quot;https://www.npmjs.com&quot;&gt;https://www.npmjs.com&lt;/a&gt;&lt;/p&gt;

    &lt;p&gt;노드를 윈도우에 깔던 맥에 깔던 리눅스에 깔던 고맙게 패스 다잡아주기 때문에 node가 잘 깔린지는 터미널 열어서 간단히 확인해보면 된다.&lt;/p&gt;

    &lt;div class=&quot;language-console highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; node -v
 npm -v
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;

    &lt;blockquote&gt;
      &lt;p&gt;설치는 너무 쉬운 것이라 구체적인 설명 패스하는데 간혹 임베디드 리눅스에서 문제가 생길 수 있다. &lt;br /&gt;
 그때는 npm을 먼저 깔고 n이라는 모듈(npm install n -g) 를 이용하면된다.. 더 자세한건 검색&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;express&lt;/p&gt;

    &lt;p&gt;노드의 웹애플리케이션 모듈이다.&lt;/p&gt;

    &lt;p&gt;한글 매뉴얼을 제공하고 있고 설치도 쉽다..&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;http://expressjs.com/ko/&quot;&gt;http://expressjs.com/ko/&lt;/a&gt;&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;자바 친구 스프링, 파이썬 친구 장고, 루비 친구 레일, 그리고 노드 친구 익스프레스가 있다..&lt;br /&gt;
 웹서버기능은 물론이며 직관적인 라우팅 설계가 가능하기 때문에 RESTful한 서버가 거저 만들 수 있다.&lt;/p&gt;
    &lt;/blockquote&gt;

    &lt;p&gt;뭐든 새롭게 시작할때 고민하는 것은..  시작을 어떻게 할 것이냐인데.. 바로 그것이 진입장벽이되어 추진력을 잃게 만든다..&lt;/p&gt;

    &lt;p&gt;그래서 있는 것이 generator! 프로젝트를 어떻게 구성할지 css는 어따 놓을 지, router들은 어떻게 모듈로 나눌 껀지 모두 다! 골격을 만들어 놓으셨다..&lt;/p&gt;

    &lt;p&gt;&lt;strong&gt;express-generator 전역설치&lt;/strong&gt;&lt;/p&gt;

    &lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; $ sudo npm install express-generator -g
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;기존에 git에 만들어두었던 nem을 nemv로 이름 변경하였다.&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/images/nemv/4.png&quot; alt=&quot;alt repo&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;&lt;strong&gt;앞전에 만든 nemv dir 밖에서 아래 실행한다. 비어있지 않기 때문에 y를 누르자&lt;/strong&gt;&lt;/p&gt;

    &lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; $ express --view=pug nemv
 destination is not empty, continue? [y/N] y
    
    create : nemv
    create : nemv/package.json
    create : nemv/app.js
    create : nemv/public
    create : nemv/routes
    create : nemv/routes/index.js
    create : nemv/routes/users.js
    create : nemv/views
    create : nemv/views/index.pug
    create : nemv/views/layout.pug
    create : nemv/views/error.pug
    create : nemv/bin
    create : nemv/bin/www
    create : nemv/public/javascripts
    create : nemv/public/stylesheets
    create : nemv/public/stylesheets/style.css
    
    install dependencies:
      $ cd nemv &amp;amp;&amp;amp; npm install
    
    run the app:
      $ DEBUG=nemv:* npm start
    
    create : nemv/public/images
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;nemv/package.json에 적혀있는 종속항목을 설치하자&lt;/strong&gt;&lt;/p&gt;

    &lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; $ cd nemv
 $ npm install
 npm notice created a lockfile as package-lock.json. You should commit this file.
 added 114 packages in 5.066s
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;이제 실행해본다&lt;/strong&gt;&lt;/p&gt;

    &lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; $ DEBUG=nemv:* npm start
 &amp;gt; nemv@0.0.0 start /Users/fkkmemi/WebstormProjects/nemv
 &amp;gt; node ./bin/www
    
   nemv:server Listening on port 3000 +0ms
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;

    &lt;p&gt;웹브라우저에서 http://localhost:3000 를 눌러본다..&lt;/p&gt;

    &lt;p&gt;아래 그림이 떳다면 성공..&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/images/nemv/5.png&quot; alt=&quot;alt hello world!&quot; /&gt;&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;아파치니 iis니도 없이 그냥 웹이 떠억 나왔다.. 간만에 다시봐도 놀라운 간결함..&lt;/p&gt;
    &lt;/blockquote&gt;

    &lt;p&gt;더 자세한 것은 아래 링크를 눌러서 확인해보면다.&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;http://expressjs.com/ko/starter/generator.html&quot;&gt;http://expressjs.com/ko/starter/generator.html&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;mongoDB&lt;/p&gt;

    &lt;p&gt;&lt;strong&gt;설치 및 설명은 이전 링크를 참고한다. &lt;a href=&quot;/mongo-sharding-1/&quot;&gt;1편 : shard 구성&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;위 링크는 샤딩에 대한 내용이라 사실 아래의 링크를 보고 따라하는 것이 낫다&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;https://www.mongodb.com/download-center#community&quot;&gt;https://www.mongodb.com/download-center#community&lt;/a&gt;&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;설치는 너무 쉬워서 패스..&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;이전 &lt;a href=&quot;/nemv-3/&quot;&gt;NEMV 3 - git 등록&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;다음 &lt;a href=&quot;/nemv-5/&quot;&gt;NEMV 5 - vue.js 설치&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;</content><author><name>fkkmemi</name><email>fkkmemi@gmail.com</email></author><category term="nemv" /><category term="node" /><category term="mongo" /><category term="express" /><category term="vue" /><summary type="html">node.js</summary></entry><entry><title type="html">NEMV 3 - git 등록</title><link href="http://localhost:4000/nemv/nemv-3/" rel="alternate" type="text/html" title="NEMV 3 - git 등록" /><published>2017-08-01T00:00:00+09:00</published><updated>2017-08-01T00:00:00+09:00</updated><id>http://localhost:4000/nemv/nemv%203</id><content type="html" xml:base="http://localhost:4000/nemv/nemv-3/">&lt;h2 id=&quot;준비&quot;&gt;준비&lt;/h2&gt;

&lt;p&gt;OS별로 약간의 차이가 있는데.. 주로 경로형식 차이 말고는 거의 차이가 없다 &lt;br /&gt;
unix(mac,linux,…) 계열과는 달리 윈도우 계열은 putty, git등을 따로 설치 해줘야하는 것 말고는 나머지는 다 멀티플랫폼이라 상관없다.&lt;/p&gt;

&lt;h3 id=&quot;git&quot;&gt;git&lt;/h3&gt;
&lt;p&gt;github를 이용하여 리포(repository)를 만들고 시작하도록 하겠다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com&quot;&gt;https://github.com&lt;/a&gt; 으로 이동&lt;/li&gt;
  &lt;li&gt;New repository click&lt;br /&gt;
&lt;img src=&quot;/images/nemv/1.png&quot; alt=&quot;alt repo&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;Create repository click&lt;br /&gt;
private로 하게되면 비공개며 월 8불을 내야하며 10개의 리포를 쓸 수 있다.&lt;br /&gt;
README 파일은 체크해두고 gitignore에 node를 선택해둔다.(불필요한 모듈들을 관리대상에서 제외시켜준다.)  &lt;br /&gt;
&lt;img src=&quot;/images/nemv/2.png&quot; alt=&quot;alt create&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;저장소 생성&lt;br /&gt;
https://github.com/id/repo 형태로 어디서든 접속되고 누구나 열람이 가능하다.(퍼블릭이기때문에 사회공헌? 도 가능하다)
&lt;img src=&quot;/images/nemv/3.png&quot; alt=&quot;alt github&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;내 작업공간에 담기&lt;br /&gt;
윈도우라면 git부터 설치해야한다..&lt;br /&gt;
적절한 공간으로 가서 복제한다.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ git clone https://github.com/fkkmemi/nem.git
Cloning into 'nem'...
remote: Counting objects: 4, done.
remote: Compressing objects: 100% (3/3), done.
remote: Total 4 (delta 0), reused 0 (delta 0), pack-reused 0
Unpacking objects: 100% (4/4), done.
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;디렉토리 내용 확인&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ls -al nem
total 16
drwxr-xr-x   5 fkkmemi  staff  170  3  8 23:58 .
drwxr-xr-x  14 fkkmemi  staff  476  3  8 23:58 ..
drwxr-xr-x  13 fkkmemi  staff  442  3  8 23:58 .git
-rw-r--r--   1 fkkmemi  staff  578  3  8 23:58 .gitignore
-rw-r--r--   1 fkkmemi  staff   26  3  8 23:58 README.md
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;README.md를 수정(git test용)
마크다운 문법으로 설정파일 위치와 아래와 같이 예시등을 넣는다..&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ vi nem/README.md 
# nem
node express mongod

## bin/config.json (default)

- db_url : 'monogodb://localhost'
- http_port : 3000
- https_port : 3001
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;git status&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;README.md는 수정됨이라고 나온다.&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cd nem
$ git status
On branch master
Your branch is up-to-date with 'origin/master'.
Changes not staged for commit:
  (use &quot;git add &amp;lt;file&amp;gt;...&quot; to update what will be committed)
  (use &quot;git checkout -- &amp;lt;file&amp;gt;...&quot; to discard changes in working directory)

    modified:   README.md

no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;git add&lt;br /&gt;
하지만 staged 상태가 아니라서 add를 하고 다시 status를 보면 녹색으로 나온다.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ git add README.md
$ git status
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;git commit&lt;br /&gt;
내가 작성했다는 도장을 찍어본다..&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ git commit -m &quot;start&quot;
[master a696ff8] start
1 file changed, 7 insertions(+)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;git push&lt;br /&gt;
이제 깃헙에 올려본다.&lt;br /&gt;
https://github.com/id/repo 에 가보면 자세한 정보를 볼 수 있다&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;일반적으로는 4,5커밋하고 푸쉬한다..&lt;br /&gt;
원래 공동작업에서는 골치아픈일이 많다.. conflict,merge등.. 하지만 혼자 쓸땐 막 쓰면된다..&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ git push origin master
Counting objects: 3, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (3/3), done.
Writing objects: 100% (3/3), 353 bytes | 0 bytes/s, done.
Total 3 (delta 0), reused 0 (delta 0)
To https://github.com/fkkmemi/nem.git
   9f96b09..a696ff8  master -&amp;gt; master
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;굳이 왜 안써도 될 것 같은 깃을 먼저 하는 이유는
단순히 버전관리의 문제가 아닌… 자세의 문제라고 생각한다..&lt;br /&gt;
프로그램은 정성이다.. 버전도 작성하고. 프로그램 이름도 고민하고..&lt;br /&gt;
뭐 이런.. 나름의 소중한 작품을 만든다는 생각으로.. 임해야한다고 본다..&lt;br /&gt;
패키징(ex:인스톨쉴드,msi)도 없이 단일 실행파일 배포는 프로의식 없이 만들었기 때문에 발전이 대체로 더뎠었다..&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;strong&gt;이전 &lt;a href=&quot;/nemv-2/&quot;&gt;NEMV 2 - API 설계&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;다음 &lt;a href=&quot;/nemv-4/&quot;&gt;NEMV 4 - node.js &amp;amp; express &amp;amp; mongoDB 설치&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;</content><author><name>fkkmemi</name><email>fkkmemi@gmail.com</email></author><category term="nemv" /><category term="node" /><category term="mongo" /><category term="express" /><category term="vue" /><summary type="html">준비</summary></entry><entry><title type="html">NEMV 2 - API 설계</title><link href="http://localhost:4000/nemv/nemv-2/" rel="alternate" type="text/html" title="NEMV 2 - API 설계" /><published>2017-08-01T00:00:00+09:00</published><updated>2017-08-01T00:00:00+09:00</updated><id>http://localhost:4000/nemv/nemv%202</id><content type="html" xml:base="http://localhost:4000/nemv/nemv-2/">&lt;h2 id=&quot;규격&quot;&gt;규격&lt;/h2&gt;

&lt;p&gt;RESTful api의 형태로 제작한다.&lt;/p&gt;

&lt;p&gt;url은 https://x.y/api 를 통해 데이터를 송수신하도록 한다.&lt;/p&gt;

&lt;p&gt;session or token 등의 인증된 보안패킷만 송수신할 수 있다.&lt;/p&gt;

&lt;p&gt;검색용 키값은 요청파라메터(url)로 전달하며 데이터는 body에 담아서 보낸다.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;POST : Create&lt;br /&gt;
데이터 송신, 생성용이며 요청시 body에 데이터를 담아서 보냄&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;GET : Retrieve&lt;br /&gt;
데이터 수신, 조회용이며 요청시 조건 파라메터로 조절&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;PUT : Update&lt;br /&gt;
데이터 송신, 수정용이며 요청시 해당데이터의 키값을 파라메터로 보냄&lt;br /&gt;
바디에는 수정할 만큼만 채워서 가변으로 보냄&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;DELETE : Delete
데이터 송신, 삭제용이며 요청시 해당데이터의 키값을 파라메터로 보냄&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;blockquote&gt;
  &lt;p&gt;데이터를 보낼때 방법이 여러가지여서 주소창에 넣을 때도 있었고 바디에 조건을 넣을 때도 있었는데..&lt;br /&gt;
경험상 용도에 가장 적합한 구조가 위의 구조 인 것 같다.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;이 문서는 다음 문서 내용과 같이 업데이트 시키도록 하겠다..&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;strong&gt;이전 &lt;a href=&quot;/nemv-1/&quot;&gt;NEMV 1 - 소개&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;다음 &lt;a href=&quot;/nemv-3/&quot;&gt;NEMV 3 - git 등록&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;</content><author><name>fkkmemi</name><email>fkkmemi@gmail.com</email></author><category term="nemv" /><category term="node" /><category term="mongo" /><category term="express" /><category term="vue" /><summary type="html">규격</summary></entry><entry><title type="html">NEMV 1 - 소개</title><link href="http://localhost:4000/nemv/nemv-1/" rel="alternate" type="text/html" title="NEMV 1 - 소개" /><published>2017-08-01T00:00:00+09:00</published><updated>2017-08-01T00:00:00+09:00</updated><id>http://localhost:4000/nemv/nemv%201</id><content type="html" xml:base="http://localhost:4000/nemv/nemv-1/">&lt;h2 id=&quot;개요&quot;&gt;개요&lt;/h2&gt;

&lt;p&gt;NEMV란?&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;NEMV(Node.js, Express, MongoDB, Vue.js)&lt;/strong&gt; 란 것이다..&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;괜히 구글링하지 말길 바란다.. 내 작명임 :&amp;lt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;현재 까지 &lt;strong&gt;NEM(Node.js, Express, MongoDB)&lt;/strong&gt; 로 잘 운영을 해왔지만.&lt;/p&gt;

&lt;p&gt;MEAN(MongoDB, Express, Angular.js, Node.js) 스택이 있다길래 나도 front-end 엔진을 탑재해보기로 했다..&lt;/p&gt;

&lt;p&gt;바로 vue.js를 추가하고 vue-cli, webpack, e2e test가 가능한 개발환경을 갖춰보도록 하겠다..&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;기존엔 그냥 개발환경 없이 js 덕덕 긁은 프론트 넣었음&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;웹서버가 단순히 브라우저에 html 파일을 전송하던 시대는 간 것 같다.&lt;/p&gt;

&lt;p&gt;언젠가부터 디바이스도 tcp socket이 아닌 http api(주로 post)를 통해 데이터 송수신을 하는 추세다.&lt;/p&gt;

&lt;p&gt;과거에는 여건이 안되었는데 그 이유는&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;tcp를 http로 감싸는 패킷 오버헤드(데이터량)&lt;br /&gt;
‘abcd’ 4바이트만 보내려해도 경우에 따라 100바이트 가량의 헤더가 추가 된다.(거기에 json화까지 시키면..)&lt;/li&gt;
  &lt;li&gt;OS기반 필요&lt;br /&gt;
non-os(쌩펌)로 https 패킷 만들기는 쉽지 않다.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;현재는 경량의 디바이스(라즈베리등)에 linux가 포팅되어 있고 통신은 wifi, lte등의 빠른 네트워크 속도와 각 통신사의 IoT요금제가 나오고 있어서 가능하다.&lt;/p&gt;

&lt;p&gt;매번 다른 서버, 디바이스에서 하던 약속(protocol)은 구구절절한 사연이 되어버린 요즘이다.&lt;/p&gt;

&lt;p&gt;트렌드에 맞는 통신, 데이터를 이용해 유지관리와 가독성이 좋은 웹으로 바꿔보도록 하겠다.&lt;/p&gt;

&lt;h2 id=&quot;설계-방향&quot;&gt;설계 방향&lt;/h2&gt;

&lt;p&gt;이 작업을 시작하며 최소한 알아야할 사전정보는 아래와 같다.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;RESTful API&lt;/p&gt;

    &lt;p&gt;Representational State Transfer의 약자, REST 서버는 클라이언트가 HTTP 프로토콜을 사용해 서버의 데이터에 조회&amp;amp;변경을 하는 것이다.&lt;br /&gt;
 데이터는 json,xml,text 등이 가능하지만, 당연히 트렌드인 json으로 간다.&lt;/p&gt;

    &lt;p&gt;http method는 4개가 있다.&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;GET&lt;/li&gt;
      &lt;li&gt;POST&lt;/li&gt;
      &lt;li&gt;PUT&lt;/li&gt;
      &lt;li&gt;DELETE&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;이 4개의 method를 아래 CRUD의 규칙에 맞게 사용하도록 한다.&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;이전엔 get, post 두개만 써왔는데 이유는 절대적인 규칙이 아닌 식별로 쓰이기 때문에 사실 급한데 아무거나 써도 무방하다고 봤다.&lt;br /&gt;
 무엇보다 ajax get call을 해서 화면 리프레쉬를 한적이 있는데 IE8에서는 오동작을 한적이 있다.(post로 바꾸면 해결.)&lt;br /&gt;
 put, delete를 사용해 restful의 느낌을 살리는 웹을 실제로는 본적이 없다..&lt;/p&gt;
    &lt;/blockquote&gt;

    &lt;p&gt;참고) POST, PUT 비교 : &lt;a href=&quot;https://1ambda.github.io/javascripts/rest-api-put-vs-post/&quot;&gt;https://1ambda.github.io/javascripts/rest-api-put-vs-post/&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;CRUD&lt;/p&gt;

    &lt;table&gt;
      &lt;thead&gt;
        &lt;tr&gt;
          &lt;th&gt;name&lt;/th&gt;
          &lt;th&gt;desc.&lt;/th&gt;
          &lt;th&gt;db&lt;/th&gt;
          &lt;th&gt;http&lt;/th&gt;
        &lt;/tr&gt;
      &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
          &lt;td&gt;Create&lt;/td&gt;
          &lt;td&gt;생성&lt;/td&gt;
          &lt;td&gt;INSERT&lt;/td&gt;
          &lt;td&gt;POST&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;Read(또는 Retrieve)&lt;/td&gt;
          &lt;td&gt;읽기(또는 인출)&lt;/td&gt;
          &lt;td&gt;SELECT&lt;/td&gt;
          &lt;td&gt;GET&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;Update&lt;/td&gt;
          &lt;td&gt;갱신&lt;/td&gt;
          &lt;td&gt;UPDATE&lt;/td&gt;
          &lt;td&gt;PUT&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;Delete(또는 Destroy)&lt;/td&gt;
          &lt;td&gt;삭제(또는 파괴)&lt;/td&gt;
          &lt;td&gt;DELETE&lt;/td&gt;
          &lt;td&gt;DELETE&lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;

    &lt;p&gt;데이터 처리에 대한 정리라고 보면 된다.&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;데이터 처리 관련 많은 어플리케이션을 만들었지만 결국 기본 4개의 의미를 벗어날 수가 없다.&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;json&lt;/p&gt;

    &lt;p&gt;json은 문서규격이지만 사실 javascript 변수라고 봐도 된다.&lt;br /&gt;
 웹은 javascript가 없으면 그냥 정적인 껍데기일 뿐..&lt;br /&gt;
 웹이 진화하고 보편화 되면서 http protocol이 웹이 아닌 곳에 쓰이게 되며 결국 웹이 잘 알아들을 수 있는 문서이자 변수인 대동단결 json을 써야하는 것이다.&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;mongoDB : json형태로 조회,수정 모든 행위가 가능(내부적으론 bson형태로 자료를 저장하기 때문에 반복적인 데이터 오버헤드에서 해방)&lt;/li&gt;
      &lt;li&gt;nodejs : body-parser를 사용하면 알아서 json으로 알아들음&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;html5&lt;/p&gt;

    &lt;p&gt;대부분이 html5는 뭔가 대단한 새로운 플랫폼이라고 생각하는데 그건 오해다.&lt;br /&gt;
 표준준수에 더 가까운 개념이라고 생각한다. 즉 룰을 잘 지키며 작성해보기로 한다.
 더 자세한건 참조 &lt;a href=&quot;https://ko.wikipedia.org/wiki/HTML5&quot;&gt;https://ko.wikipedia.org/wiki/HTML5&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;다음 &lt;a href=&quot;/nemv-2/&quot;&gt;NEMV 2 - API 설계&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;</content><author><name>fkkmemi</name><email>fkkmemi@gmail.com</email></author><category term="nemv" /><category term="node" /><category term="mongo" /><category term="express" /><category term="vue" /><summary type="html">개요</summary></entry><entry><title type="html">Communication(통신) 5. 구현-수신</title><link href="http://localhost:4000/communication/comm-5/" rel="alternate" type="text/html" title="Communication(통신) 5. 구현-수신" /><published>2017-07-20T00:00:00+09:00</published><updated>2017-07-20T00:00:00+09:00</updated><id>http://localhost:4000/communication/comm%205</id><content type="html" xml:base="http://localhost:4000/communication/comm-5/">&lt;h3 id=&quot;개요&quot;&gt;개요&lt;/h3&gt;

&lt;p&gt;이제 바이트 단위로 파악하여 원하는 데이터를 꺼내보도록 하겠다..&lt;/p&gt;

&lt;h3 id=&quot;수신&quot;&gt;수신&lt;/h3&gt;

&lt;p&gt;우선 코드를 작성 후 설명해보겠다.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;rx(r)&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;step&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;com&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//command&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;len&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[],&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;log&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;//중략  &lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;tx&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;//중략&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;rx&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x09&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;com&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; 
                &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[];&lt;/span&gt;
                &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;readUInt32LE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                    &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[];&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;                          &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;chksum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;chksum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
                &lt;span class=&quot;nx&quot;&gt;chksum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;chksum&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;chksum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x90&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                    &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;                    
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;                
                &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;c1&quot;&gt;//idle&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;decode&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;//data 처리&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;제어변수 R.step과 지난번 “ABCD” 패킷이 왔다고 생각하고 확인해보자.&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;0x9 0x0 0x4 0x0 0x0 0x0 0x41 0x42 0x43 0x44 0xa 0x90 
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;해석&quot;&gt;해석&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;0&lt;br /&gt;
9(0x09) 인지 확인하고 넘김.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;1&lt;br /&gt;
‘커맨드 : 0’ 저장하고 가용버퍼 비우고 넘김.
    &lt;blockquote&gt;
      &lt;p&gt;다음 받을 것이 4바이트를 채워야하기 때문&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;2&lt;br /&gt;
스텝이 2인 상태에서 4번에 걸쳐 [0x4 0x0 0x0 0x0] 데이터를 받는다.&lt;br /&gt;
형변환 하여 ‘길이 : 4’ 저장하고 가용버퍼 비우고 넘김.&lt;br /&gt;
최소한의 예외처리 0보다 크고 1000보다 작으면 넘김.&lt;br /&gt;
그렇지 않을 경우 다시 처음부터 시작한다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;3&lt;br /&gt;
스텝이 3인 상태에서 앞전에 받아 놓은 ‘길이 : 4’ 만큼 [0x41 0x42 0x43 0x44] 데이터를 받고 넘김.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;4&lt;br /&gt;
‘보낸 데이터 : 0xa’ 와 받은 데이터[0x41 0x42 0x43 0x44]의 ‘checksum : 0x0A’ 과 맞는지 확인하고 맞으면 넘김.&lt;br /&gt;
그렇지 않을 경우 다시 처음부터 시작한다.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;5&lt;br /&gt;
144(0x90) 인지 확인하고 넘기고 디코드&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;6
아무것도 안하고 decode가 끝나길 기다림…&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;스텝6는 대체 왜 필요할까?&lt;br /&gt;
스텝5에서 0으로 만들면 되지 않을까? 라고 생각할 수 있다..&lt;br /&gt;
데이터가 연달아서 오면 어떻게 될까?&lt;br /&gt;
0x9 0x0 0x4 0x0 0x0 0x0 0x41 0x42 0x43 0x44 0xa 0x90 0x9 0x3 0x3 0x0 0x0 0x0 0x31 0x32 0x33 0xa 0x90&lt;br /&gt;
decode가 10초 이상 걸리는(DB work) 펑션인데 블러킹해놓고 돌리지 않으면 decode 중에 R.len R.com 등이 바뀔 수 있다..&lt;br /&gt;
그러므로 queue,ring등의 개념을 활용해 decode가 아닐때만 rx(r)의 r은 queue에서 빼다 쓰고 평소엔 queue 적재를 하는 방법을 구상해야한다..(이건 추후에..)   &lt;br /&gt;
node는 callback을 활용해서 처리해야하지만..&lt;br /&gt;
다른 플랫폼 c/java등은 대부분 decode중 블러킹(decode가 끝나야 다음 일을 함) 상태이 때문에 간단하게 작성한 코드이다..&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;상당히 단순해 보이는 코드지만 규약되지 않는 이상한 데이터들을 다 막아주며 본코드와 차이가 있지만 기본은 검증이 다 된 코드다..&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;이제 데이터를 프로토콜에 맞춰 만들어서 디코드를 해보겠다.&lt;/p&gt;

&lt;p&gt;이전에 만든 가공 펑션을 이용해서 패킷을 만들어보자.&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;let msg = Buffer.alloc(20);
msg.write(&quot;FKKMEMI&quot;); //10byte는 보내는 사람 이름
msg.write(&quot;U LOVE ME?&quot;,10); //10byte는 내용
console.log(logh(makebuf(0x00,msg)));
//printed
//0x9 0x0 0x14 0x0 0x0 0x0 0x46 0x4b 0x4b 0x4d 0x45 0x4d 0x49 0x0 0x0 0x0 0x55 0x20 0x4c 0x4f 0x56 0x45 0x20 0x4d 0x45 0x3f 0xa0 0x90 
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;다시 프로토콜을 확인 해보면&lt;/strong&gt; 아래와 같은 패킷이었다.&lt;/p&gt;

&lt;h5 id=&quot;send&quot;&gt;send&lt;/h5&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt; &lt;/th&gt;
      &lt;th&gt;받는 사람&lt;/th&gt;
      &lt;th&gt;내용&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;길이&lt;/td&gt;
      &lt;td&gt;10&lt;/td&gt;
      &lt;td&gt;1~140&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;유형&lt;/td&gt;
      &lt;td&gt;char&lt;/td&gt;
      &lt;td&gt;char&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h5 id=&quot;ack&quot;&gt;ack&lt;/h5&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt; &lt;/th&gt;
      &lt;th&gt;내용&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;길이&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;유형&lt;/td&gt;
      &lt;td&gt;int&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;strong&gt;decode()&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;step&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;com&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//command&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;len&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[],&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;log&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;//중략  &lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;tx&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;//중략&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;rx&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;//중략&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;decode&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//message&lt;/span&gt;
                &lt;span class=&quot;nx&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'ascii'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;[\0]&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;/g&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;nx&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'ascii'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;[\0]&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;/g&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//another commands ...&lt;/span&gt;
            &lt;span class=&quot;nl&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;MSGs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},{&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;$set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x00&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,[&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x00&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x00&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,[&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;            
        &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;해석-1&quot;&gt;해석&lt;/h4&gt;

&lt;p&gt;decode는 아래와 같이 최소한 4단계의 과정이 필요하다.&lt;/p&gt;

&lt;p&gt;*parse &amp;gt; store &amp;gt; send ack &amp;gt; ready&lt;/p&gt;

&lt;h5 id=&quot;parse&quot;&gt;parse&lt;/h5&gt;

&lt;p&gt;&lt;strong&gt;let d 는 현재 [0x46 0x4b 0x4b 0x4d 0x45 0x4d 0x49 0x0 0x0 0x0 0x55 0x20 0x4c 0x4f 0x56 0x45 0x20 0x4d 0x45 0x3f] 의 데이터를 가지고 있다.&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;받는 사람은 10바이트로 지정했기 때문에 [0x46 0x4b 0x4b 0x4d 0x45 0x4d 0x49 0x0 0x0 0x0] 가 된다.
    &lt;ul&gt;
      &lt;li&gt;아스키 테이블을 확인하며 한바이트 씩 확인 해보면 7byte는 “FKKMEMI” 임을 알 수 있다.&lt;/li&gt;
      &lt;li&gt;스트링에서 0의 의미는 문자가 끝났다는 표현이다.&lt;/li&gt;
      &lt;li&gt;하지만 별도의 스트링파서를 넣지 않았기 때문에 이상한 문자가 될 수 있다.&lt;/li&gt;
      &lt;li&gt;그래서 regexp로 종료케릭터(‘\0’ : 0x00)는 제거했다.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;내용은 가변이며 length(0x14:20)개 이기 때문에 나머지 바이트는 [0x55 0x20 0x4c 0x4f 0x56 0x45 0x20 0x4d 0x45 0x3f] 가 된다.
    &lt;ul&gt;
      &lt;li&gt;아스키 테이블을 확인하며 한바이트 씩 확인 해보면 10byte는 “U LOVE ME?” 임을 알 수 있다.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h5 id=&quot;store&quot;&gt;store&lt;/h5&gt;

&lt;ul&gt;
  &lt;li&gt;file로 저장하든 db에 저장하든..&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;위의 예제는 mongoose를 이용한 방법이다..&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h5 id=&quot;send-1&quot;&gt;send&lt;/h5&gt;

&lt;ul&gt;
  &lt;li&gt;저장은 오래 걸릴 수 있으므로 꼭 callback을 받고 보낸다.&lt;/li&gt;
  &lt;li&gt;DB 처리중 에러가 있다면
    &lt;ul&gt;
      &lt;li&gt;R.tx(0x00,[0x00]); 못 저장했다고 0을 보낸다.&lt;/li&gt;
      &lt;li&gt;R.tx(0x00,[0x01]); 잘 저장했다고 1을 보낸다.
        &lt;blockquote&gt;
          &lt;p&gt;실제 패킷 : 0x9 0x0 0x1 0x0 0x0 0x0 0x01 0x01 0x90&lt;/p&gt;
        &lt;/blockquote&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h5 id=&quot;ready&quot;&gt;ready&lt;/h5&gt;

&lt;ul&gt;
  &lt;li&gt;모든 처리 완료 후 스텝을 0으로 만든다.
    &lt;blockquote&gt;
      &lt;p&gt;사실 Send도 callback을 받아야 명확하다…&lt;br /&gt;
R.tx(0x00,[0x01],function(err) {R.step=0}); 형태로 제작해야한다..&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;통신-연재는-여기까지&quot;&gt;통신 연재는 여기까지..&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;피곤해서 급 종료..&lt;/p&gt;
&lt;/blockquote&gt;</content><author><name>fkkmemi</name><email>fkkmemi@gmail.com</email></author><category term="communication" /><category term="communication" /><category term="node" /><summary type="html">개요</summary></entry><entry><title type="html">Communication(통신) 4. 구현-송신</title><link href="http://localhost:4000/communication/comm-4/" rel="alternate" type="text/html" title="Communication(통신) 4. 구현-송신" /><published>2017-07-19T00:00:00+09:00</published><updated>2017-07-19T00:00:00+09:00</updated><id>http://localhost:4000/communication/comm%204</id><content type="html" xml:base="http://localhost:4000/communication/comm-4/">&lt;h3 id=&quot;개요&quot;&gt;개요&lt;/h3&gt;

&lt;p&gt;바이트로 들어오는 데이터를 이제 명확하게 확인 할 수 있는 준비가 되었으니 실제 프로토콜을 이용해 송/수신 을 구현해보겠다.&lt;/p&gt;

&lt;h3 id=&quot;송신&quot;&gt;송신&lt;/h3&gt;

&lt;p&gt;수신부를 테스트 하려면 송신부를 먼저 만들어야 된다..&lt;/p&gt;

&lt;p&gt;제작된 프로토콜 기반으로 바이트(s)를 만들어보겠다..&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;가공 펑션을 만들어보자&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;makebuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// 빈 버퍼를 만든다 start + command + length + data.length + checksum + end&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;alloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; 
    &lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x09&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;writeUInt32LE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;chksum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;chksum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;        
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;chksum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x90&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;가공 펑션을 사용해 헥사 스트링을 만들어보자&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;send&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x41&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x42&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x43&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x44&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;makebuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x00&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;lh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;logh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;lh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;//이렇게 한줄로 줄일 수도 있다.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;logh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;makebuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x00&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ABCD&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))));&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;//printed&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//-&amp;gt; 0x9 0x0 0x4 0x0 0x0 0x0 0x41 0x42 0x43 0x44 0xa 0x90 &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;프로토콜 대로 체크를 다시 해보면&lt;/p&gt;

&lt;p&gt;0x09 = start
0x00 = command
0x04 0x00 0x00 0x00 = length
0x41 0x42 0x43 0x44 = data
0x0A = checksum
0x90 = end&lt;/p&gt;

&lt;p&gt;대부분 이해가 가는 내용이지만 바이트 처리를 처음 해본 사람이라면 궁금한 것이 있을 것이다..&lt;/p&gt;

&lt;p&gt;바로 length 일 것이다.. 0x00 0x00 0x00 0x04 가 맞아보이는데…&lt;/p&gt;

&lt;p&gt;우선 endian이라는 개념을 꼭 알아야만한다. 사실 프로토콜에도 명시를 해줘야 한다..&lt;/p&gt;

&lt;p&gt;해당 링크 참조하여 숙지하도록 한다.. &lt;strong&gt;&lt;a href=&quot;https://ko.wikipedia.org/wiki/엔디언&quot;&gt;https://ko.wikipedia.org/wiki/엔디언&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;buf.writeUInt32LE(data.length,2) -&amp;gt; buf[2] 부터 LittleEndian(LE)으로 32비트(4바이트)를 쓰겠다는 의미이다..&lt;/p&gt;

&lt;p&gt;대부분의 시스템(PC,임베디드장비,모바일)은 리틀엔디안을 쓰고 있는데 뒤집어서 저장을 하는 것이다..&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;과거 설계 당시 효율 때문이었다는데.. 관심 있는 사람은 더 찾아보면 재밌을 것 같다.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;0x12345678 이라는 변수는 피씨에는 0x78 0x56 0x34 0x12로 저장되어 있는 것이다..&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;c/c++ 확인법&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;unsigned long l = 0x12345678;
unsigned char c[4];
memcpy(c,&amp;amp;l,4);
String s = &quot;&quot;;
for(int i = 0; i &amp;lt; 4; i++) s += &quot;0x&quot; + IntToHex(c[i],2) + &quot; &quot;;
print(s);
//printed
//0x78 0x56 0x34 0x12 
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;엔디안의 결론은 한바이트 이상의 정수에서만 필요한 개념이다.&lt;/p&gt;

&lt;h3 id=&quot;수신&quot;&gt;수신&lt;/h3&gt;

&lt;p&gt;수신부는 복잡하다 한바이트 씩 카운팅 해야하므로 제어변수가 들어가야 할 수 있다..&lt;/p&gt;

&lt;p&gt;서버는 클라이언트와 달리 늘 멀티 접속을 고려해야한다.. 접속한 클라이언트 마다 컨테이너를 생성해주고 관리를 해줘야한다..&lt;/p&gt;

&lt;p&gt;해당 커넥션이 연결되어 있을 때 그 클라이언트만의 변수가 있어야 된다는 것이다..&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;c++의 경우 커넥션이 이루어질때 &lt;code class=&quot;highlighter-rouge&quot;&gt;sock = new Conn(dclass);&lt;/code&gt;  형태로 메모리 할당이 필요하지만.&lt;br /&gt;
디스커넥트일때 메모리 해제도 잊지 말아야한다..&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;node net module은 간단하게 구현된다.. 그것도 싱글쓰레드 논블러킹으로..&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;원래 서버 수신 코드에 아래와 같이 변수를 추가해본다..&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;net&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createServer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; 
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'open : '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;remoteAddress&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;        
    &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'close'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'close : '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;remoteAddress&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'error'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'error : '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;remoteAddress&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' / '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;    
    &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'data'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;logh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;listen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1234&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;그리고 여러대의 클라이언트에서 접속하며 데이터를 쏴보면 해당 커넥션의 변수가 각각 증가함을 알수가 있다..&lt;/p&gt;

&lt;p&gt;var count 는 각각의 컨테이너에서 잘 지내고 있음을 확인할 수 있는 것이다..&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;바이트 처리를 위한 최소한의 변수를 만들어 보겠다..&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;step&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;com&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//command&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;len&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//가변 배열&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;구분편의를 위해 obj형으로 만들었으며 걍 따로 만들어도 된다.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;node V8 engine 덕에 저정도면 되는 것이다..&lt;br /&gt;
c/c++만 해도 배열 민/맥스로 할지 동적으로 할지 length, count 등 몇개가 더 필요하다.&lt;br /&gt;
가비지 컬렉터에게 모든 걸 맡겨놔도 후회 없다.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;strong&gt;object 변수에 위에 작성한 tx를 넣어보자&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;step&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;com&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//command&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;len&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[],&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;tx&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;alloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; 
        &lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x09&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;writeUInt32LE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;chksum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;chksum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;        
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;chksum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x90&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;이제 R.tx() 펑션으로 언제든지 연결된 소켓에 데이터를 보낼 수 있게되었다.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;코드 가독성도 나아지고 있다.. :)&lt;br /&gt;
tx : (command, data) =&amp;gt; { 는 function tx(command, data) { 와 같다.&lt;br /&gt;
ecmascript 6 버전 표현력으로 끝에 지저분한 }), 형태를 막아준다.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;strong&gt;object 변수에 로깅용 함수도 추가하고 rx를 만들어서 수신할때 한바이트 씩 들어가게 해본다..&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;net&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createServer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; 
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;step&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;com&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//command&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;len&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[],&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;log&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;===&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'data is empty'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;hs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;h&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;h&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'0'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;nx&quot;&gt;hs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'0x'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;h&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;hs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;   
        &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;tx&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;alloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; 
            &lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x09&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;writeUInt32LE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;chksum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
                &lt;span class=&quot;nx&quot;&gt;chksum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;        
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;chksum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x90&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;rx&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;//여기서 한바이트 작업..&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'open : '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;remoteAddress&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;        
    &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'close'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'close : '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;remoteAddress&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'error'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'error : '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;remoteAddress&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' / '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;    
    &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'data'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;rx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;listen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1234&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;이제 좀 가독성이 좋아져서 커넥션 독자적으로 무언 가를 넣고 싶은 마음이 생겼다 :)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;결론&quot;&gt;결론&lt;/h3&gt;

&lt;p&gt;이제 R.rx() 코드 작성을 통해 받기만 하면 된다&lt;/p&gt;</content><author><name>fkkmemi</name><email>fkkmemi@gmail.com</email></author><category term="communication" /><category term="communication" /><category term="node" /><summary type="html">개요</summary></entry><entry><title type="html">Communication(통신) 3. 구현-기본</title><link href="http://localhost:4000/communication/comm-3/" rel="alternate" type="text/html" title="Communication(통신) 3. 구현-기본" /><published>2017-07-18T00:00:00+09:00</published><updated>2017-07-18T00:00:00+09:00</updated><id>http://localhost:4000/communication/comm%203</id><content type="html" xml:base="http://localhost:4000/communication/comm-3/">&lt;h3 id=&quot;개요&quot;&gt;개요&lt;/h3&gt;

&lt;p&gt;간단하게 프로토콜을 만들어보았다. 이제 정의된 프로토콜 대로 구현해보도록 하겠다..&lt;/p&gt;

&lt;h3 id=&quot;준비&quot;&gt;준비&lt;/h3&gt;

&lt;h4 id=&quot;클라이언트&quot;&gt;클라이언트&lt;/h4&gt;

&lt;p&gt;테스트를 하려면 소켓 접속,종료 바이너리 데이터를 보내고 받을 수 있는 어플리케이션이 있어야한다..&lt;/p&gt;

&lt;p&gt;윈도우 프로그램이나 node webkit으로 10줄 정도면 만들지만 포스팅 에너지가 많이 들어가므로 알아서 다운받든 만들든 해서 쓸 툴이 준비되어있어야한다..(시간될 때 추후에 한번 다뤄보겠다 얼마나 쉬운지..)&lt;/p&gt;

&lt;h4 id=&quot;서버&quot;&gt;서버&lt;/h4&gt;

&lt;p&gt;바이너리 프로토콜이니 우선 어떤 데이터가 들어오는 지 바이트를 확인 할 수 있는 루틴이 제일 중요하다..&lt;/p&gt;

&lt;p&gt;node.js의 net module : &lt;a href=&quot;https://nodejs.org/dist/latest-v6.x/docs/api/net.html&quot;&gt;https://nodejs.org/dist/latest-v6.x/docs/api/net.html&lt;/a&gt; 을 사용해 구현해보겠다..&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;실제로 작업에 들어갈 때는 구글링(스택오버등) 하기전에 항상 레퍼런스 사이트를 정독하자.. 
아래코드도 레퍼런스 대로 추가했을 뿐 절대 의미 없는 코드를 만들지 않는다…&lt;br /&gt;
이해가 중요한 것이다 C++, java, python, ruby 도 똑같이 구현해보면 된다..&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;접속&quot;&gt;접속&lt;/h4&gt;

&lt;p&gt;우선 연결 유무를 판단해야한다..&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;net&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'net'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;net&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createServer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'open : '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;remoteAddress&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;// Add a 'close' event handler to this instance of socket&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'close'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'close : '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;remoteAddress&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;listen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1234&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;localhost:1234로 socket을 open 해놓고 리스닝 중인 것이다.&lt;/p&gt;

&lt;p&gt;누군 가 접속을 하면 ‘open + #.#.#.#’ 이 뜰 것이고&lt;/p&gt;

&lt;p&gt;소켓을 닫으면 ‘close + #.#.#.#’ 이 뜰 것이다.&lt;/p&gt;

&lt;h4 id=&quot;에러-처리&quot;&gt;에러 처리&lt;/h4&gt;

&lt;p&gt;그런데 갑자기 의도치않게 소켓 연결 에러가 나버리면? 서버는 리셋되게 되어 있다.&lt;/p&gt;

&lt;p&gt;이벤트 핸들러를 정해주지 않아 갈곳을 잃었기 때문..&lt;/p&gt;

&lt;p&gt;그러니 에러 핸들러를 추가해주자..&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;net&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createServer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;    
    &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'open : '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;remoteAddress&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;        
    &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'close'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'close : '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;remoteAddress&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'error'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'error : '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;remoteAddress&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' / '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;    
&lt;span class=&quot;p&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;listen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1234&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;데이터-수신&quot;&gt;데이터 수신&lt;/h4&gt;

&lt;p&gt;대부분의 서버는 chunk 즉 바이트 덩어리로 무작위 길이로 날아온다..&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;net&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createServer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;    
    &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'open : '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;remoteAddress&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;        
    &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'close'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'close : '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;remoteAddress&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'error'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'error : '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;remoteAddress&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' / '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;    
    &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'data'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;listen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1234&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;client에서 ‘ABCD’ 를 날려보자..&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;이정도는 unix 계열이라면 nc localhost 1234 정도로 테스트 해도 된다.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;[0x41,0x42,0x43,0x44] 의 버퍼형 데이터가 올 것이다..&lt;/p&gt;

&lt;p&gt;노드의 버퍼 시스템으로는 Buffer.from([0x41,0x42,0x43,0x44]) 과 내용이 같다..&lt;/p&gt;

&lt;p&gt;참고 node buffer : &lt;a href=&quot;https://nodejs.org/dist/latest-v6.x/docs/api/buffer.html&quot;&gt;https://nodejs.org/dist/latest-v6.x/docs/api/buffer.html&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;위 링크만 대충 봐도 바이트와 스트링과의 관계를 이해할 수 있다.&lt;br /&gt;
C++, java, python 서버소켓도 만들어봤지만 당연히 같은 원리로 들어온다…&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;strong&gt;들어올 데이터가 스트링인 것을 알고 있다면?&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'data'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;이렇게 함으로써 “ABCD” 임을 확인 할 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;데이터 량이 많아질 경우 “…” 처리가 되고 c등의 원시적인 소켓 모듈에서는 버퍼를 표현(스트링으로 치환해야함)하기가 힘들 수 있으므로 범용적으로 쓸 수 있는 String을 만들어본다.&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;net&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createServer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;    
    &lt;span class=&quot;nx&quot;&gt;sock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'data'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;//console.log(data);&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//중간에 데이터가 들어오기 때문에 아래 for에서 직접쓰면 오류가 날수 있으므로 길이를 적어둔다&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;hs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;hs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'0x'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;hs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;        
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;listen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1234&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;이제 ABCD 를 보내면 0x41 0x42 0x43 0x44 로 확인이 된다.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;각 언어별 헥스스트링 method 찾아서 data[i].toString(16) 부분을 바꾸면 된다..&lt;br /&gt;
eg) c++ : IntToHex(data[i],2)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;strong&gt;보낼 때도 써야하니 함수로 만들어 놓는 것이 좋겠다..&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;logh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;hs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;hs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'0x'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;hs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;   
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;결론&quot;&gt;결론&lt;/h3&gt;

&lt;p&gt;바이너리던 스트링이던 html이던 json이던 xml이든 이제 모든 데이터는 헥스 스트링으로 판단할 수 있게 되었다.&lt;/p&gt;

&lt;p&gt;다음에는 그 어떤 데이터가 오더라도 뻥뻥 터지지 않는 서버를 위해 한바이트 한바이트 소중히 해석하며 처리할 수 있는 서버를 만들어보겠다..&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;수신서버는 방화벽이 애니오픈이어야할 경우기 때문에 더더욱 한땀 한땀 체크하는게 당연한 것이다..&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;http packet이 궁금하지 않은가? 브라우저에서 http://localhost:1234 접속해보면..  &lt;br /&gt;
0x47 0x45 0x54 0x20 0x2F 0x20 0x48 0x54 0x54 … http protocol 뭔지 적나라하게 보일 것이다..&lt;/p&gt;
&lt;/blockquote&gt;</content><author><name>fkkmemi</name><email>fkkmemi@gmail.com</email></author><category term="communication" /><category term="communication" /><category term="node" /><summary type="html">개요</summary></entry></feed>